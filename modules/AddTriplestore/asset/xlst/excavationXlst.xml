<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xmlns:sh="http://www.w3.org/ns/shacl#"
    xmlns:ah="http://www.purl.com/ah/ms/ahMS#"
    xmlns:ah-vocab="http://www.purl.com/ah/kos#"
    xmlns:excav="https://purl.org/ah/ms/excavationMS#"
    xmlns:dct="http://purl.org/dc/terms/"
    xmlns:foaf="http://xmlns.com/foaf/0.1/"
    xmlns:schema="http://schema.org/"
    xmlns:voaf="http://purl.org/vocommons/voaf#"
    xmlns:vann="http://purl.org/vocab/vann/"
    xmlns:dbo="http://dbpedia.org/ontology/"
    xmlns:time="http://www.w3.org/2006/time#"
    xmlns:edm="http://www.europeana.eu/schemas/edm#"
    xmlns:dul="http://www.ontologydesignpatterns.org/ont/dul/DUL.owl#"
    xmlns:crm="http://www.cidoc-crm.org/cidoc-crm/"
    xmlns:crmsci="https://cidoc-crm.org/extensions/crmsci/"
    xmlns:crmarchaeo="http://www.cidoc-crm.org/extensions/crmarchaeo/"
    xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
    exclude-result-prefixes="xsl rdf xsd rdfs sh ah ah-vocab excav dct foaf schema voaf vann dbo time edm dul crm crmsci crmarchaeo geo">

    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

    <xsl:template match="/">
        <rdf:RDF>
            <xsl:apply-templates/>  </rdf:RDF>
    </xsl:template>

    <xsl:template match="//Excavation">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="Identifier"/>  </xsl:attribute>
            <rdf:type rdf:resource="http://www.cidoc-crm.org/cidoc-crm/E7_Activity"/>
            <dct:identifier>
                <xsl:value-of select="Identifier"/>
            </dct:identifier>
            <xsl:if test="Location">
                <dul:hasLocation rdf:resource="{Location/@ref}"/>
            </xsl:if>
            <xsl:if test="PersonInCharge">
                <excav:hasPersonInCharge rdf:resource="{PersonInCharge/@ref}"/>
            </xsl:if>
            <xsl:for-each select="Context">
                <excav:hasContext rdf:resource="{@ref}"/>
            </xsl:for-each>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//Archaeologist">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                 <xsl:value-of select="Account"/>   </xsl:attribute>
            <rdf:type rdf:resource="https://purl.org/ah/ms/excavationMS#Archaeologist"/>
            <foaf:account>
                <xsl:value-of select="Account"/>
            </foaf:account>
            <xsl:if test="Name">
                <foaf:name>
                    <xsl:value-of select="Name"/>
                </foaf:name>
            </xsl:if>
            <xsl:for-each select="Mbox">
                <foaf:mbox>
                    <xsl:value-of select="."/>
                </foaf:mbox>
            </xsl:for-each>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//Context">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="Identifier"/>   </xsl:attribute>
            <rdf:type rdf:resource="http://www.cidoc-crm.org/cidoc-crm/E8_Acquisition"/>
            <dct:identifier>
                <xsl:value-of select="Identifier"/>
            </dct:identifier>
            <xsl:for-each select="SVU">
                <excav:hasSVU rdf:resource="{SVU/@ref}"/>
            </xsl:for-each>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//SVU">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="Identifier"/>   </xsl:attribute>
            <rdf:type rdf:resource="http://www.cidoc-crm.org/cidoc-crm/E9_Move"/>
            <dct:identifier>
                <xsl:value-of select="Identifier"/>
            </dct:identifier>
            <xsl:if test="Description">
                <dct:description>
                    <xsl:value-of select="Description"/>
                </dct:description>
            </xsl:if>
            <xsl:if test="TimeLine">
                <excav:hasTimeLine rdf:resource="{TimeLine/@ref}"/>
            </xsl:if>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//Place">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="InformationName"/>   </xsl:attribute>
            <rdf:type rdf:resource="http://dbpedia.org/ontology/Place"/>
            <xsl:if test="InformationName">
                <dbo:informationName>
                    <xsl:value-of select="InformationName"/>
                </dbo:informationName>
            </xsl:if>
            <xsl:if test="GPSCoordinates">
                <excav:hasGPSCoordinates rdf:resource="{GPSCoordinates/@ref}"/>
            </xsl:if>
            <xsl:if test="District">
                <dbo:district rdf:resource="{District/@ref}"/>
            </xsl:if>
            <xsl:if test="Parish">
                <dbo:Parish rdf:resource="{Parish/@ref}"/>
            </xsl:if>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//GPSCoordinates">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="lat"/>   <xsl:value-of select="long"/>
            </xsl:attribute>
            <rdf:type rdf:resource="http://www.w3.org/2003/01/geo/wgs84_pos#SpatialThing"/>
            <xsl:if test="lat">
                <geo:lat>
                    <xsl:value-of select="lat"/>
                </geo:lat>
            </xsl:if>
            <xsl:if test="long">
                <geo:long>
                    <xsl:value-of select="long"/>
                </geo:long>
            </xsl:if>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//TemporalEntity">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="."/>   </xsl:attribute>
            <rdf:type rdf:resource="http://www.w3.org/2006/time#TemporalEntity"/>
            <xsl:for-each select="hasBeginning">
                <time:hasBeginning rdf:resource="{hasBeginning/@ref}"/>
            </xsl:for-each>
            <xsl:for-each select="hasEnd">
                <time:hasEnd rdf:resource="{hasEnd/@ref}"/>
            </xsl:for-each>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//Instant">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="inXSDYear"/>   </xsl:attribute>
            <rdf:type rdf:resource="http://www.w3.org/2006/time#Instant"/>
            <xsl:if test="inXSDYear">
                <time:inXSDYear>
                    <xsl:value-of select="inXSDYear"/>
                </time:inXSDYear>
            </xsl:if>
            <xsl:if test="bc">
                <excav:bc>
                    <xsl:value-of select="bc"/>
                </excav:bc>
            </xsl:if>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//District">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="InformationName"/>   </xsl:attribute>
            <rdf:type rdf:resource="http://dbpedia.org/ontology/District"/>
            <dbo:informationName>
                <xsl:value-of select="InformationName"/>
            </dbo:informationName>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//Parish">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="InformationName"/>   </xsl:attribute>
            <rdf:type rdf:resource="http://dbpedia.org/ontology/Parish"/>
            <dbo:informationName>
                <xsl:value-of select="InformationName"/>
            </dbo:informationName>
        </rdf:Description>
    </xsl:template>

    <xsl:template match="//EncounterEvent">
        <rdf:Description>
            <xsl:attribute name="rdf:about">
                <xsl:value-of select="."/>   </xsl:attribute>
            <rdf:type rdf:resource="https://cidoc-crm.org/extensions/crmsci/S19_Encounter_Event"/>
            <xsl:if test="date">
                <dct:date>
                    <xsl:value-of select="date"/>
                </dct:date>
            </xsl:if>
            <xsl:if test="depth">
                <dbo:depth>
                    <xsl:value-of select="depth"/>
                </dbo:depth>
            </xsl:if>
            <xsl:if test="foundInSVU">
                <excav:foundInSVU rdf:resource="{foundInSVU/@ref}"/>
            </xsl:if>
            <xsl:if test="foundInAContext">
                <excav:foundInAContext rdf:resource="{foundInAContext/@ref}"/>
            </xsl:if>
            <xsl:if test="foundInAExcavation">
                <excav:foundInAExcavation rdf:resource="{foundInAExcavation/@ref}"/>
            </xsl:if>
        </rdf:Description>
    </xsl:template>
</xsl:stylesheet>