<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:excav="https://purl.org/ah/ms/excavationMS#"
    xmlns:dct="http://purl.org/dc/terms/"
    xmlns:dul="http://www.ontologydesignpatterns.org/ont/dul/DUL.owl#"
    xmlns:dbo="http://dbpedia.org/ontology/"
    xmlns:foaf="http://xmlns.com/foaf/0.1/"
    xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
    xmlns:time="http://www.w3.org/2006/time#"
    xmlns:crmarchaeo="http://www.cidoc-crm.org/extensions/crmarchaeo/"
    xmlns:crmsci="https://cidoc-crm.org/extensions/crmsci/">
    
    <xsl:output method="xml" indent="yes"/>
    
    <xsl:template match="/">
        <rdf:RDF>
            <xsl:apply-templates/>
        </rdf:RDF>
    </xsl:template>
    
    <!-- Excavation -->
    <xsl:template match="Excavation">
        <crmarchaeo:A9_Archaeological_Excavation>
            <dct:identifier><xsl:value-of select="Identifier"/></dct:identifier>
            <xsl:if test="Location">
                <dul:hasLocation rdf:resource="{Location}"/>
            </xsl:if>
            <xsl:if test="PersonInCharge">
                <excav:hasPersonInCharge rdf:resource="{PersonInCharge}"/>
            </xsl:if>
            <xsl:for-each select="Contexts/Context">
                <excav:hasContext rdf:resource="{.}"/>
            </xsl:for-each>
        </crmarchaeo:A9_Archaeological_Excavation>
    </xsl:template>
    
    <!-- Archaeologist -->
    <xsl:template match="Archaeologist">
        <excav:Archaeologist>
            <foaf:account rdf:resource="{Account}"/>
            <xsl:if test="Name">
                <foaf:name><xsl:value-of select="Name"/></foaf:name>
            </xsl:if>
            <xsl:for-each select="Emails/Email">
                <foaf:mbox rdf:resource="{.}"/>
            </xsl:for-each>
        </excav:Archaeologist>
    </xsl:template>
    
    <!-- Context -->
    <xsl:template match="Context">
        <crmarchaeo:A1_Excavation_Processing_Unit>
            <dct:identifier><xsl:value-of select="Identifier"/></dct:identifier>
            <xsl:for-each select="SVUs/SVU">
                <excav:hasSVU rdf:resource="{.}"/>
            </xsl:for-each>
        </crmarchaeo:A1_Excavation_Processing_Unit>
    </xsl:template>
    
    <!-- Stratigraphic Volume Unit (SVU) -->
    <xsl:template match="SVU">
        <crmarchaeo:A2_Stratigraphic_Volume_Unit>
            <dct:identifier><xsl:value-of select="Identifier"/></dct:identifier>
            <xsl:if test="Description">
                <dct:description><xsl:value-of select="Description"/></dct:description>
            </xsl:if>
            <xsl:if test="TimeLine">
                <excav:hasTimeLine rdf:resource="{TimeLine}"/>
            </xsl:if>
        </crmarchaeo:A2_Stratigraphic_Volume_Unit>
    </xsl:template>
    
    <!-- Encounter Event -->
    <xsl:template match="EncounterEvent">
        <crmsci:S19_Encounter_Event>
            <xsl:if test="Date">
                <dct:date><xsl:value-of select="Date"/></dct:date>
            </xsl:if>
            <xsl:if test="Depth">
                <dbo:depth><xsl:value-of select="Depth"/></dbo:depth>
            </xsl:if>
            <xsl:if test="FoundInSVU">
                <excav:foundInSVU rdf:resource="{FoundInSVU}"/>
            </xsl:if>
            <xsl:if test="FoundInContext">
                <excav:foundInAContext rdf:resource="{FoundInContext}"/>
            </xsl:if>
            <xsl:if test="FoundInExcavation">
                <excav:foundInAExcavation rdf:resource="{FoundInExcavation}"/>
            </xsl:if>
        </crmsci:S19_Encounter_Event>
    </xsl:template>
    
</xsl:stylesheet>
