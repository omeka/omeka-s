<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:ah="http://www.purl.com/ah/ms/ahMS#"
    xmlns:ah-shape="http://www.purl.com/ah/kos/ah-shape/"
    xmlns:ah-variant="http://www.purl.com/ah/kos/ah-variant/"
    xmlns:ah-base="http://www.purl.com/ah/kos/ah-base/"
    xmlns:ah-chippingMode="http://www.purl.com/ah/kos/ah-chippingMode/"
    xmlns:ah-chippingDirection="http://www.purl.com/ah/kos/ah-chippingDirection/"
    xmlns:ah-chippingDelineation="http://www.purl.com/ah/kos/ah-chippingDelineation/"
    xmlns:ah-chippingLocation="http://www.purl.com/ah/kos/ah-chippingLocation/"
    xmlns:ah-chippingShape="http://www.purl.com/ah/kos/ah-chippingShape/"
    xmlns:crm="http://www.cidoc-crm.org/cidoc-crm/"
    xmlns:excav="https://purl.org/ah/ms/excavationMS#">

    <xsl:output method="xml" indent="yes"/>
    <xsl:template match="/">
        <rdf:RDF>
            <xsl:apply-templates/>
        </rdf:RDF>
    </xsl:template>

    <xsl:template match="item">
        <crm:E24_Physical_Man-Made_Thing rdf:about="ah:arrowhead{substring-after(@id, 'AH')}"> 
            <ah:hasId><xsl:value-of select="@id"/></ah:hasId>
            <ah:hasAnnotation><xsl:value-of select="annotation"/></ah:hasAnnotation>
            <xsl:for-each select="shape">  
                <ah:shape rdf:resource="{.}"/> 
            </xsl:for-each>

            <xsl:if test="variant"> 
                <ah:variant rdf:resource="{variant}"/>
            </xsl:if>

            <xsl:if test="point">
                 <ah:point><xsl:value-of select="point"/></ah:point>
            </xsl:if>

            <xsl:if test="body">
                <ah:body><xsl:value-of select="body"/></ah:body>
            </xsl:if>

            <xsl:if test="base">
                <ah:base rdf:resource="{base}"/>
            </xsl:if>

            <xsl:if test="mode">
                <ah:mode rdf:resource="{mode}"/>
            </xsl:if>

            <xsl:if test="amplitude">
                <ah:amplitude><xsl:value-of select="amplitude"/></ah:amplitude>
            </xsl:if>

            <xsl:for-each select="direction[position() &lt;= 3]">
                <ah:direction rdf:resource="{.}"/>
            </xsl:for-each>

            <xsl:if test="orientation">
                <ah:orientation><xsl:value-of select="orientation"/></ah:orientation>
            </xsl:if>

            <xsl:if test="delineation">
                <ah:delineation rdf:resource="{delineation}"/>
            </xsl:if>

            <xsl:for-each select="chippinglocation-Side[position() &lt;= 3]">  
                <ah:chippinglocation-Side rdf:resource="{.}"/>
            </xsl:for-each>

            <xsl:for-each select="chippinglocation-Transversal[position() &lt;= 3]">  
                <ah:chippinglocation-Transversal rdf:resource="{.}"/>
            </xsl:for-each>

            <xsl:if test="chippingShape">
                <ah:chippingShape rdf:resource="{chippingShape}"/>
            </xsl:if>

            <xsl:if test="hasMedia">
                <ah:hasMedia rdf:resource="{hasMedia}"/>
            </xsl:if>

            <xsl:if test="foundInAExcavation">
                <excav:foundInAExcavation rdf:resource="{foundInAExcavation}"/>
            </xsl:if>


            <xsl:if test="foundInAContext">
                <excav:foundInAContext rdf:resource="{foundInAContext}"/>
            </xsl:if>

            <xsl:if test="foundInSVU">
                <excav:foundInSVU rdf:resource="{foundInSVU}"/>
            </xsl:if>


        </crm:E24_Physical_Man-Made_Thing>
    </xsl:template>

</xsl:stylesheet>